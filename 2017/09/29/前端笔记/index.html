<!DOCTYPE html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<!-- 背景动画 -->
<script type="text/javascript" src="/js/src/particle.js"></script>


  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    /*.pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }*/
</style>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="学习,javascript," />





  <link rel="alternate" href="/atom.xml" title="哎哟，不错哦" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/headpic.ico?v=5.1.2" />






<meta name="description" content="checkbox全选全不选：    prop用于操作元素的固有属性    attr用于自定义属性    $(“#all”).click(function(){        if(this.checked){            $(“#list :checkbox”).prop(“checked”, true);        }else{        $(“#list :checkbox">
<meta name="keywords" content="学习,javascript">
<meta property="og:type" content="article">
<meta property="og:title" content="前端笔记">
<meta property="og:url" content="http://yoursite.com/2017/09/29/前端笔记/index.html">
<meta property="og:site_name" content="哎哟，不错哦">
<meta property="og:description" content="checkbox全选全不选：    prop用于操作元素的固有属性    attr用于自定义属性    $(“#all”).click(function(){        if(this.checked){            $(“#list :checkbox”).prop(“checked”, true);        }else{        $(“#list :checkbox">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2017-09-29T06:22:08.595Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="前端笔记">
<meta name="twitter:description" content="checkbox全选全不选：    prop用于操作元素的固有属性    attr用于自定义属性    $(“#all”).click(function(){        if(this.checked){            $(“#list :checkbox”).prop(“checked”, true);        }else{        $(“#list :checkbox">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":true,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/09/29/前端笔记/"/>






  <title>前端笔记 | 哎哟，不错哦</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?cde7ed0fa94a278a5a206a5e44b45936";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

    <script type="text/javascript" src="/live2d/script.js"></script>
    <canvas id="live2dcanvas" width="150" height="300" class="live2d"></canvas>
    <style>
      #live2dcanvas {
        position: fixed;
        right: 0px;
        z-index: 999;
        pointer-events: none;
        bottom: -20px;
      }
    </style>
    <script>loadlive2d("live2dcanvas" ,"/live2d/assets/Unitychan/unitychan.model.json",0.5)</script>
  
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">哎哟，不错哦</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">远走高飞</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-首页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-关于我">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于我
          </a>
        </li>
      
        
        <li class="menu-item menu-item-标签">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-技术">
          <a href="/technology/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-dashboard"></i> <br />
            
            技术
          </a>
        </li>
      
        
        <li class="menu-item menu-item-分类">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-照片">
          <a href="/photo/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-image"></i> <br />
            
            照片
          </a>
        </li>
      
        
        <li class="menu-item menu-item-生活">
          <a href="/life/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heart"></i> <br />
            
            生活
          </a>
        </li>
      
        
        <li class="menu-item menu-item-文章">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            文章
          </a>
        </li>
      
        
        <li class="menu-item menu-item-日程">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程
          </a>
        </li>
      
        
        <li class="menu-item menu-item-网站地图">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            网站地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/29/前端笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="高哥哥">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headpic.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="哎哟，不错哦">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">前端笔记</h2>
        

        <div class="post-meta">
          <span class="post-time">
            

            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2017-09-29T14:22:08+08:00">
                2017-09-29
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/学习/" itemprop="url" rel="index">
                    <span itemprop="name">学习</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/学习/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/09/29/前端笔记/" class="leancloud_visitors" data-flag-title="前端笔记">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>℃
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>分钟
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="\assets\js\APlayer.min.js"> </script><p>checkbox全选全不选：<br>    prop用于操作元素的固有属性<br>    attr用于自定义属性<br>    $(“#all”).click(function(){<br>        if(this.checked){<br>            $(“#list :checkbox”).prop(“checked”, true);<br>        }else{<br>        $(“#list :checkbox”).prop(“checked”, false);<br>        }<br>    });<br>    iframe内的元素操作外部元素：<br>        $(‘.cropped’).delegate(“img”, “click”, function () {<br>        var headpicsrc=$(this).attr(“src”);<br>        //$(“.modal-backdrop.in”).removeClass(“in”);<br>        $(‘#header-pic img’, window.parent.document).attr(“src”, headpicsrc);<br>        $(‘#.modal-backdrop.in’, window.parent.document).attr(“src”, headpicsrc);<br>        $(‘#filePath’, window.parent.document).val(tempArr[0]);<br>        });<br>        jaquery.data()保存后台传来的数据：<br>         //存<br>         $(‘body’).data(‘kaoqi’,data.location);<br>         //取<br>         console.log($(‘body’).data(‘kaoqi’));<br>         jquery的selected选择器：<br>          var companychkworksetid=$(“#position”).find(“option:selected”).attr(“data-id”);<br>          var pacalendarmodelinfoid=$(“#company”).find(“option:selected”).attr(“data-id”);<br>          var starttime=$(“#company”).find(“option:selected”).attr(“data-start”);<br>          var endtime=$(“#company”).find(“option:selected”).attr(“data-end”);</p>
<pre><code>    $(&quot;input[type=radio]&quot;):checked
    selected下拉表单赋值：
    $(&quot;#province&gt;option:selected&quot;).val(data.Province);
    $(&quot;#city&gt;option:selected&quot;).html(data.City);

    &lt;select class=&quot;form-control&quot; id=&quot;province&quot; name=&quot;province&quot;&gt;
    &lt;option value=&quot;&quot; data-code=&quot;&quot;&gt;—— 省 ——&lt;/option&gt;
    &lt;option value=&quot;北京市&quot; data-code=&quot;110000&quot; selected=&quot;&quot;&gt;北京市&lt;/option&gt;
    &lt;option value=&quot;天津市&quot; data-code=&quot;120000&quot;&gt;天津市&lt;/option&gt;
    &lt;option value=&quot;河北省&quot; data-code=&quot;130000&quot;&gt;河北省&lt;/option&gt;
    获取地址栏数据：
    var url = document.location.href;
    var rid = url.split(&quot;=&quot;)[1];
        function GetQueryString(name)
                    {
                        var reg = new RegExp(&quot;(^|&amp;)&quot; + name + &quot;=([^&amp;]*)(&amp;|$)&quot;);
                        var r = window.location.search.substr(1).match(reg);
                        if (r != null) return unescape(r[2]); return null;
                    }
                    var account = GetQueryString(&quot;mail&quot;);
    http://localhost:8097/UserCenter/active?mail=123@qq.com
    秒数转换成时间格式：
    /Date(1478849129000)/&quot;
    var str = data.RegisterDatetime;
                    var d = eval(&apos;new &apos; + str.substr(1, str.length - 2));
                    var ar_date = [d.getFullYear(), d.getMonth() + 1, d.getDate()];
                    function dFormat(i)
                    {
                        return i &lt; 10 ? &quot;0&quot; + i.toString() : i;
                    }
                    for (var i = 0; i &lt; ar_date.length; i++) ar_date[i] = dFormat(ar_date[i]);
                    $(&quot;#registertime&quot;).val(ar_date.join(&apos;-&apos;));
手机页面框架：
html{font-size: 32px;}
body{-webkit-tap-highlight-color:rgba(0,0,0,0);在手机上点击链接去除背景}
//iphone 6
@media (min-device-width : 375px) {
   html{font-size: 64px;}
}
// iphone6 plus
@media (min-device-width : 414px) {
    html{font-size: 75px;}
}
*/
/@media (device-height:568px) and (-webkit-min-device-pixel-ratio:2){/* 兼容iphone5,因为5和4的屏幕宽度一样 */}
@media only screen and (max-device-width :480px){ }
@media only screen and (min-device-width :481px){ }

/*6*/
@media (min-device-width : 375px) and (max-device-width : 667px) and (-webkit-min-device-pixel-ratio : 2){ }

/*6+*/
@media (min-device-width : 414px) and (max-device-width : 736px) and (-webkit-min-device-pixel-ratio : 3){ }

/*魅族*/
@media only screen and (min-device-width :1080px) and (-webkit-min-device-pixel-ratio : 2.5){ }

/*mate7*/
@media only screen and (min-device-width :1080px) and (-webkit-min-device-pixel-ratio : 3){ }

/*4 4s*/
@media only screen and (device-height :480px) and (-webkit-device-pixel-ratio:2){ }

@media screen and (min-width: 320px) and (max-width: 480px) {  }

/* 平板之类的宽度 1024 以下设备 */
@media only screen and (min-width: 321px) and (max-width: 1024px) {
body {
background: blue;
}
}

/* PC客户端或大屏幕设备: 1028px 至更大 */
@media only screen and (min-width: 1029px) {
body {
background: green;
}
}
</code></pre><p> H5问题：<br> meta基础知识<br> H5页面窗口自动调整到设备宽度，并禁止用户缩放页面<br> <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><br> 忽略将页面中的数字识别为电话号码<br> <meta name="format-detection" content="telephone=no"><br> 忽略Android平台中对邮箱地址的识别<br> <meta name="format-detection" content="email=no"><br> 当网站添加到主屏幕快速启动方式，可隐藏地址栏，仅针对ios的safari<br> <meta name="apple-mobile-web-app-capable" content="yes"><br> <!-- ios7.0版本以后，safari上已看不到效果 --><br> 将网站添加到主屏幕快速启动方式，仅针对ios的safari顶端状态条的样式<br> <meta name="apple-mobile-web-app-status-bar-style" content="black"><br> <!-- 可选default、black、black-translucent --><br> viewport模板<br> viewport模板——通用<br> &lt;!DOCTYPE html&gt;<br> <html><br> <head><br> <meta charset="utf-8"><br> <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport"><br> <meta content="yes" name="apple-mobile-web-app-capable"><br> <meta content="black" name="apple-mobile-web-app-status-bar-style"><br> <meta content="telephone=no" name="format-detection"><br> <meta content="email=no" name="format-detection"><br> <title>标题</title><br> <link rel="stylesheet" href="index.css"><br> </head></html></p>
 <body><br> 这里开始内容<br> </body>

<p> <br> viewport模板 – target-densitydpi=device-dpi，android 2.3.5以下版本不支持<br> &lt;!DOCTYPE html&gt;<br> <html><br> <head><br> <meta charset="utf-8"><br> <meta name="viewport" content="width=750, user-scalable=no, target-densitydpi=device-dpi"><!-- width取值与页面定义的宽度一致 --><br> <meta content="yes" name="apple-mobile-web-app-capable"><br> <meta content="black" name="apple-mobile-web-app-status-bar-style"><br> <meta content="telephone=no" name="format-detection"><br> <meta content="email=no" name="format-detection"><br> <title>标题</title><br> <link rel="stylesheet" href="index.css"><br> </head></html></p>
 <body><br> 这里开始内容<br> </body>

<p> <br> 参考案例：<a href="http://action.weixin.qq.com/payact/readtemplate?t=mobile/2015/wxzfsht/index_tmpl" target="_blank" rel="external">http://action.weixin.qq.com/payact/readtemplate?t=mobile/2015/wxzfsht/index_tmpl</a><br> 常见问题<br> 移动端如何定义字体font-family<br> 中文字体使用系统默认即可，英文用Helvetica<br> /<em> 移动端定义字体的代码 </em>/<br> body{font-family:Helvetica;}<br> 参考《移动端使用字体的思考》<br> 移动端字体单位font-size选择px还是rem<br> 对于只需要适配少部分手机设备，且分辨率对页面影响不大的，使用px即可<br> 对于需要适配各种移动设备，使用rem，例如只需要适配iPhone和iPad等分辨率差别比较挺大的设备<br> rem配置参考：<br> html{font-size:10px}<br> @media screen and (min-width:321px) and (max-width:375px){html{font-size:11px}}<br> @media screen and (min-width:376px) and (max-width:414px){html{font-size:12px}}<br> @media screen and (min-width:415px) and (max-width:639px){html{font-size:15px}}<br> @media screen and (min-width:640px) and (max-width:719px){html{font-size:20px}}<br> @media screen and (min-width:720px) and (max-width:749px){html{font-size:22.5px}}<br> @media screen and (min-width:750px) and (max-width:799px){html{font-size:23.5px}}<br> @media screen and (min-width:800px){html{font-size:25px}}<br> 移动端touch事件(区分webkit 和 winphone)<br> 当用户手指放在移动设备在屏幕上滑动会触发的touch事件<br> 以下支持webkit<br> touchstart——当手指触碰屏幕时候发生。不管当前有多少只手指<br> touchmove——当手指在屏幕上滑动时连续触发。通常我们再滑屏页面，会调用event的preventDefault()可以阻止默认情况的发生：阻止页面滚动<br> touchend——当手指离开屏幕时触发<br> touchcancel——系统停止跟踪触摸时候会触发。例如在触摸过程中突然页面alert()一个提示框，此时会触发该事件，这个事件比较少用<br> TouchEvent<br> touches：屏幕上所有手指的信息<br> targetTouches：手指在目标区域的手指信息<br> changedTouches：最近一次触发该事件的手指信息<br> touchend时，touches与targetTouches信息会被删除，changedTouches保存的最后一次的信息，最好用于计算手指信息<br> 参数信息(changedTouches[0])<br> clientX、clientY在显示区的坐标<br> target：当前元素<br> 参考：<a href="https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent</a><br> 以下支持winphone 8<br> MSPointerDown——当手指触碰屏幕时候发生。不管当前有多少只手指<br> MSPointerMove——当手指在屏幕上滑动时连续触发。通常我们再滑屏页面，会调用css的html{-ms-touch-action: none;}可以阻止默认情况的发生：阻止页面滚动<br> MSPointerUp——当手指离开屏幕时触发<br> 移动端click屏幕产生200-300 ms的延迟响应<br> 移动设备上的web网页是有300ms延迟的，玩玩会造成按钮点击延迟甚至是点击失效。<br> 以下是历史原因，来源一个公司内一个同事的分享：<br> 2007年苹果发布首款iphone上IOS系统搭载的safari为了将适用于PC端上大屏幕的网页能比较好的展示在手机端上，使用了双击缩放(double tap to zoom)的方案，比如你在手机上用浏览器打开一个PC上的网页，你可能在看到页面内容虽然可以撑满整个屏幕，但是字体、图片都很小看不清，此时可以快速双击屏幕上的某一部分，你就能看清该部分放大后的内容，再次双击后能回到原始状态。<br> 双击缩放是指用手指在屏幕上快速点击两次，iOS 自带的 Safari 浏览器会将网页缩放至原始比例。<br> 原因就出在浏览器需要如何判断快速点击上，当用户在屏幕上单击某一个元素时候，例如跳转链接<a href="”#”"></a>，此处浏览器会先捕获该次单击，但浏览器不能决定用户是单纯要点击链接还是要双击该部分区域进行缩放操作，所以，捕获第一次单击后，浏览器会先Hold一段时间t，如果在t时间区间里用户未进行下一次点击，则浏览器会做单击跳转链接的处理，如果t时间里用户进行了第二次单击操作，则浏览器会禁止跳转，转而进行对该部分区域页面的缩放操作。那么这个时间区间t有多少呢？在IOS safari下，大概为300毫秒。这就是延迟的由来。造成的后果用户纯粹单击页面，页面需要过一段时间才响应，给用户慢体验感觉，对于web开发者来说是，页面js捕获click事件的回调函数处理，需要300ms后才生效，也就间接导致影响其他业务逻辑的处理。<br> 解决方案：<br> fastclick可以解决在手机上点击事件的300ms延迟<br> zepto的touch模块，tap事件也是为了解决在click的延迟问题<br> 触摸事件的响应顺序<br> ontouchstart<br> ontouchmove<br> ontouchend<br> onclick<br> 解决300ms延迟的问题，也可以通过绑定ontouchstart事件，加快对事件的响应<br> 什么是Retina 显示屏，带来了什么问题<br> retina：一种具备超高像素密度的液晶屏，同样大小的屏幕上显示的像素点由1个变为多个，如在同样带下的屏幕上，苹果设备的retina显示屏中，像素点1个变为4个<br> 在高清显示屏中的位图被放大，图片会变得模糊，因此移动端的视觉稿通常会设计为传统PC的2倍<br> 那么，前端的应对方案是：<br> 设计稿切出来的图片长宽保证为偶数，并使用backgroud-size把图片缩小为原来的1/2<br> //例如图片宽高为：200px*200px，那么写法如下<br> .css{width:100px;height:100px;background-size:100px 100px;}<br> 其它元素的取值为原来的1/2，例如视觉稿40px的字体，使用样式的写法为20px<br> .css{font-size:20px}<br> 参考《高清显示屏原理及设计方案》<br> ios系统中元素被触摸时产生的半透明灰色遮罩怎么去掉<br> ios用户点击一个链接，会出现一个半透明灰色遮罩, 如果想要禁用，可设置-webkit-tap-highlight-color的alpha值为0，也就是属性值的最后一位设置为0就可以去除半透明灰色遮罩<br> a,button,input,textarea{-webkit-tap-highlight-color: rgba(0,0,0,0;)}<br> 部分android系统中元素被点击时产生的边框怎么去掉<br> android用户点击一个链接，会出现一个边框或者半透明灰色遮罩, 不同生产商定义出来额效果不一样，可设置-webkit-tap-highlight-color的alpha值为0去除部分机器自带的效果<br> a,button,input,textarea{<br> -webkit-tap-highlight-color: rgba(0,0,0,0;)<br> -webkit-user-modify:read-write-plaintext-only;<br> }<br> -webkit-user-modify有个副作用，就是输入法不再能够输入多个字符<br> 另外，有些机型去除不了，如小米2<br> 对于按钮类还有个办法，不使用a或者input标签，直接用div标签<br> 参考《如何去除android上a标签产生的边框》<br> winphone系统a、input标签被点击时产生的半透明灰色背景怎么去掉<br> <meta name="msapplication-tap-highlight" content="no"><br> webkit表单元素的默认外观怎么重置<br> .css{-webkit-appearance:none;}<br> webkit表单输入框placeholder的颜色值能改变么<br> input::-webkit-input-placeholder{color:#AAAAAA;}<br> input:focus::-webkit-input-placeholder{color:#EEEEEE;}<br> webkit表单输入框placeholder的文字能换行么<br> ios可以，android不行~<br> 在textarea标签下都可以换行~<br> IE10（winphone8）表单元素默认外观如何重置<br> 禁用 select 默认下拉箭头<br> ::-ms-expand 适用于表单选择控件下拉箭头的修改，有多个属性值，设置它隐藏 (display:none) 并使用背景图片来修饰可得到我们想要的效果。<br> select::-ms-expand {<br> display: none;<br> }<br> 禁用 radio 和 checkbox 默认样式<br> ::-ms-check 适用于表单复选框或单选按钮默认图标的修改，同样有多个属性值，设置它隐藏 (display:none) 并使用背景图片来修饰可得到我们想要的效果。<br> input[type=radio]::-ms-check,<br> input[type=checkbox]::-ms-check<br> {<br> display: none;<br> }<br> 禁用PC端表单输入框默认清除按钮<br> 当表单文本输入框输入内容后会显示文本清除按钮，::-ms-clear 适用于该清除按钮的修改，同样设置使它隐藏 (display:none) 并使用背景图片来修饰可得到我们想要的效果。<br> <a href="http://www.cnblogs.com/wangpenghui522/p/5398137.html" target="_blank" rel="external">http://www.cnblogs.com/wangpenghui522/p/5398137.html</a></p>
<p> input[type=text]::-ms-clear,<br> input[type=tel]::-ms-clear,<br> input[type=number]::-ms-clear<br> {<br> display: none;<br> }<br> 禁止ios 长按时不触发系统的菜单，禁止ios&amp;android长按时下载图片<br> .css{-webkit-touch-callout: none}<br> 禁止ios和android用户选中文字<br> .css{-webkit-user-select:none}<br> 参考《如何改变表单元素的外观(for Webkit and IE10)》<br> 打电话发短信写邮件怎么实现<br> 打电话<br> <a href="tel:0755-10086" target="_blank" rel="external">打电话给:0755-10086</a><br> 发短信，winphone系统无效<br> <a href="sms:10086" target="_blank" rel="external">发短信给: 10086</a><br> 写邮件，可参考《移动web页面给用户发送邮件的方法》<br> <a href="mailto:peun@foxmail.com" target="_blank" rel="external">peun@foxmail.com</a><br> 模拟按钮hover效果<br> 移动端触摸按钮的效果，可明示用户有些事情正要发生，是一个比较好体验，但是移动设备中并没有鼠标指针，使用css的hover并不能满足我们的需求，还好国外有个激活css的active效果，代码如下，<br> &lt;!DOCTYPE html&gt;<br> <html><br> <head><br> <meta charset="utf-8"><br> <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport"><br> <meta content="yes" name="apple-mobile-web-app-capable"><br> <meta content="black" name="apple-mobile-web-app-status-bar-style"><br> <meta content="telephone=no" name="format-detection"><br> <meta content="email=no" name="format-detection"><br> <style type="text/css"><br> a{-webkit-tap-highlight-color: rgba(0,0,0,0);}<br> .btn-blue{display:block;height:42px;line-height:42px;text-align:center;border-radius:4px;font-size:18px;color:#FFFFFF;background-color: #4185F3;}<br> .btn-blue:active{background-color: #357AE8;}<br> </style><br> </head><br> <body></body></html></p>
 <div class="btn-blue">按钮</div>

<p> <script type="text/javascript"><br> document.addEventListener(“touchstart”, function(){}, true)<br> </script><br> <br> <br> 兼容性ios5+、部分android 4+、winphone 8<br> 要做到全兼容的办法，可通过绑定ontouchstart和ontouchend来控制按钮的类名<br> &lt;!DOCTYPE html&gt;<br> <html><br> <head><br> <meta charset="utf-8"><br> <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport"><br> <meta content="yes" name="apple-mobile-web-app-capable"><br> <meta content="black" name="apple-mobile-web-app-status-bar-style"><br> <meta content="telephone=no" name="format-detection"><br> <meta content="email=no" name="format-detection"><br> <style type="text/css"><br> a{-webkit-tap-highlight-color: rgba(0,0,0,0);}<br> .btn-blue{display:block;height:42px;line-height:42px;text-align:center;border-radius:4px;font-size:18px;color:#FFFFFF;background-color: #4185F3;}<br> .btn-blue-on{background-color: #357AE8;}<br> </style><br> </head><br> <body></body></html></p>
 <div class="btn-blue">按钮</div>

<p> <script type="text/javascript"><br> var btnBlue = document.querySelector(“.btn-blue”);<br> btnBlue.ontouchstart = function(){<br> this.className = “btn-blue btn-blue-on”<br> }<br> btnBlue.ontouchend = function(){<br> this.className = “btn-blue”<br> }<br> </script><br> <br> <br> 屏幕旋转的事件和样式<br> 事件<br> window.orientation，取值：正负90表示横屏模式、0和180表现为竖屏模式；<br> window.onorientationchange = function(){<br> switch(window.orientation){<br> case -90:<br> case 90:<br> alert(“横屏:” + window.orientation);<br> case 0:<br> case 180:<br> alert(“竖屏:” + window.orientation);<br> break;<br> }<br> }<br> 样式<br> //竖屏时使用的样式<br> @media all and (orientation:portrait) {<br> .css{}<br> }</p>
<p> //横屏时使用的样式<br> @media all and (orientation:landscape) {<br> .css{}<br> }<br> audio元素和video元素在ios和andriod中无法自动播放<br> 应对方案：触屏即播<br> $(‘html’).one(‘touchstart’,function(){<br> audio.play()<br> })<br> 可参考《无法自动播放的audio元素》<br> 摇一摇功能<br> HTML5 deviceMotion：封装了运动传感器数据的事件，可以获取手机运动状态下的运动加速度等数据。<br> 手机拍照和上传图片<br> <input type="”file”">的accept 属性<br> <!-- 选择照片 --><br> <input type="file" accept="image/*"><br> <!-- 选择视频 --><br> <input type="file" accept="video/*"><br> 使用总结：<br> ios 有拍照、录像、选取本地图片功能<br> 部分android只有选取本地图片功能<br> winphone不支持<br> input控件默认外观丑陋<br> 微信浏览器用户调整字体大小后页面矬了，怎么阻止用户调整<br> 原因<br> android侧是复写了layoutinflater 对textview做了统一处理<br> ios侧是修改了body.style.webkitTextSizeAdjust值<br> 解决方案：<br> android使用以下代码，该接口只在微信浏览器下有效(感谢jationhuang同学提供)<br> /**</p>
<ul>
<li>页面加入这段代码可使Android机器页面不再受到用户字体缩放强制改变大小</li>
<li>但是会有一个1秒左右的延迟，期间可以考虑通过loading展示</li>
<li>仅供参考<br><em>/<br>(function(){<br>if (typeof(WeixinJSBridge) == “undefined”) {<br>document.addEventListener(“WeixinJSBridgeReady”, function (e) {<br>setTimeout(function(){<br>WeixinJSBridge.invoke(‘setFontSizeCallback’,{“fontSize”:0}, function(res) {<br>alert(JSON.stringify(res));<br>});<br>},0);<br>});<br>} else {<br>setTimeout(function(){<br>WeixinJSBridge.invoke(‘setFontSizeCallback’,{“fontSize”:0}, function(res) {<br>alert(JSON.stringify(res));<br>});<br>},0);<br>}<br>})();<br>ios使用-webkit-text-size-adjust禁止调整字体大小<br>body{-webkit-text-size-adjust: 100%!important;}<br>最好的解决方案：<br>整个页面用rem或者百分比布局<br>消除transition闪屏<br>网络都是这么写的，但我并没有测试出来<br>.css{<br>/</em>设置内嵌的元素在 3D 空间如何呈现：保留 3D<em>/<br>-webkit-transform-style: preserve-3d;<br>/</em>（设置进行转换的元素的背面在面对用户时是否可见：隐藏）<em>/<br>-webkit-backface-visibility: hidden;<br>}<br>开启硬件加速<br>解决页面闪白<br>保证动画流畅<br>.css {<br>-webkit-transform: translate3d(0, 0, 0);<br>-moz-transform: translate3d(0, 0, 0);<br>-ms-transform: translate3d(0, 0, 0);<br>transform: translate3d(0, 0, 0);<br>}<br>参考《用CSS开启硬件加速来提高网站性能》<br>取消input在ios下，输入的时候英文首字母的默认大写<br><input autocapitalize="off" autocorrect="off"><br>android 上去掉语音输入按钮<br>input::-webkit-input-speech-button {display: none}<br>android 2.3 bug<br>@-webkit-keyframes 需要以0%开始100%结束，0%的百分号不能去掉<br>after和before伪类无法使用动画animation<br>border-radius不支持%单位<br>translate百分比的写法和scale在一起会导致失效，例如-webkit-transform: translate(-50%,-50%) scale(-0.5, 1)<br>android 4.x bug<br>三星 Galaxy S4中自带浏览器不支持border-radius缩写<br>同时设置border-radius和背景色的时候，背景色会溢出到圆角以外部分<br>部分手机(如三星)，a链接支持鼠标:visited事件，也就是说链接访问后文字变为紫色<br>android无法同时播放多音频audio<br>参考《border-radius 移动之伤》<br>设计高性能CSS3动画的几个要素<br>尽可能地使用合成属性transform和opacity来设计CSS3动画，不使用position的left和top来定位<br>利用translate3D开启GPU加速<br>参考《High Performance Animations》<br>fixed bug<br>ios下fixed元素容易定位出错，软键盘弹出时，影响fixed元素定位<br>android下fixed表现要比iOS更好，软键盘弹出时，不会影响fixed元素定位<br>ios4下不支持position:fixed<br>解决方案<br>可用isroll.js，暂无完美方案<br>参考<br>《移动端web页面使用position:fixed问题总结》<br>《使用iScroll.js解决ios4下不支持position:fixed的问题》<br>如何阻止windows Phone的默认触摸事件<br>winphone下默认触摸事件事件使用e.preventDefault是无效的<br>目前解决方法是使用样式来禁用<br>html{-ms-touch-action: none;}/</em> 禁止winphone默认触摸事件 */<br>参考<br>《Windows phone 8 touch support》<br>播放视频不全屏<!--
1.ios7+支持自动播放
2.支持Airplay的设备（如：音箱、Apple TV)播放
x-webkit-airplay="true"
3.播放视频不全屏
webkit-playsinline="true"
-->
<video x-webkit-airplay="true" webkit-playsinline="true" preload="auto" autoplay src="http://"></video><br>常用的移动端框架<br>zepto.js<br>语法与jquery几乎一样，会jquery基本会zepto~<br>最新版本已经更新到1.16<br>官网：<a href="http://zeptojs.com/" target="_blank" rel="external">http://zeptojs.com/</a><br>中文(非官网)：<a href="http://www.css88.com/doc/zeptojs_api/" target="_blank" rel="external">http://www.css88.com/doc/zeptojs_api/</a><br>常使用的扩展模块：<br>浏览器检测：<a href="https://github.com/madrobby/zepto/blob/master/src/detect.js" target="_blank" rel="external">https://github.com/madrobby/zepto/blob/master/src/detect.js</a><br>tap事件：<a href="https://github.com/madrobby/zepto/blob/master/src/touch.js" target="_blank" rel="external">https://github.com/madrobby/zepto/blob/master/src/touch.js</a><br>iscroll.js<br>解决页面不支持弹性滚动，不支持fixed引起的问题~<br>实现下拉刷新，滑屏，缩放等功能~<br>最新版本已经更新到5.0<br>官网：<a href="http://cubiq.org/iscroll-5" target="_blank" rel="external">http://cubiq.org/iscroll-5</a><br>underscore.js<br>笔者没用过，不过听说好用，推荐给大家~<br>该库提供了一整套函数式编程的实用功能，但是没有扩展任何JavaScript内置对象。<br>最新版本已经更新到1.8.2<br>官网：<a href="http://underscorejs.org/" target="_blank" rel="external">http://underscorejs.org/</a><br>滑屏框架<br>适合上下滑屏、左右滑屏等滑屏切换页面的效果<br>slip.js<br>iSlider.js<br>fullpage.js<br>flex布局<br>flex布局目前可使用在移动中，并非所有的语法都全兼容，但以下写法笔者实践过，效果良好~<br>/<em> ============================================================<br>flex：定义布局为盒模型<br>flex-v：盒模型垂直布局<br>flex-1：子元素占据剩余的空间<br>flex-align-center：子元素垂直居中<br>flex-pack-center：子元素水平居中<br>flex-pack-justify：子元素两端对齐<br>兼容性：ios 4+、android 2.3+、winphone8+<br>============================================================ </em>/<br>.flex{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}<br>.flex-v{-webkit-box-orient:vertical;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}<br>.flex-1{-webkit-box-flex:1;-webkit-flex:1;-ms<br>手机自适应js：<br>var dpr, rem, scale;<br>var docEl = document.documentElement;<br>var fontEl = document.createElement(‘style’);<br>var metaEl = document.querySelector(‘meta[name=”viewport”]’);</li>
</ul>
<p>dpr = window.devicePixelRatio || 1;<br>rem = docEl.clientWidth * dpr / 10;<br>scale = 1 / dpr;</p>
<p>// 设置viewport，进行缩放，达到高清效果<br>metaEl.setAttribute(‘content’, ‘width=’ + dpr * docEl.clientWidth + ‘,initial-scale=’ + scale + ‘,maximum-scale=’ + scale + ‘, minimum-scale=’ + scale + ‘,user-scalable=no’);</p>
<p>// 设置data-dpr属性，留作的css hack之用<br>docEl.setAttribute(‘data-dpr’, dpr);</p>
<p>// 动态写入样式<br>docEl.firstElementChild.appendChild(fontEl);<br>fontEl.innerHTML = ‘html{font-size:’ + rem + ‘px!important;}’;</p>
<p>// 给js调用的，某一dpr下rem和px之间的转换函数<br>window.rem2px = function(v) {<br>    v = parseFloat(v);<br>    return v * rem;<br>};<br>window.px2rem = function(v) {<br>    v = parseFloat(v);<br>    return v / rem;<br>};</p>
<p>window.dpr = dpr;<br>css三角形：</p>
<p>#triangle-left {<br>    width: 0;<br>    height: 0;<br>    border-top: 50px solid transparent;<br>    border-right: 100px solid red;<br>    border-bottom: 50px solid transparent;<br>}</p>

      
    </div>
    
    
    
    <div>
          
            

          
    </div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>糊口啊,大哥</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/weixin.png" alt="高哥哥 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/zhifubao.png" alt="高哥哥 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/学习/" rel="tag"><i class="fa fa-tag"></i> 学习</a>
          
            <a href="/tags/javascript/" rel="tag"><i class="fa fa-tag"></i> javascript</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/09/29/js框架对比/" rel="next" title="js框架对比">
                <i class="fa fa-chevron-left"></i> js框架对比
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="vcomments"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section ++
      ="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <img class="site-author-image" itemprop="image"
              src="/images/headpic.png"
              alt="高哥哥" />
          
            <p class="site-author-name" itemprop="name">高哥哥</p>
            <p class="site-description motion-element" itemprop="description"></p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives">
            
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/gao5252" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>GitHub</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:1055652678@qq.com?subject=高" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/bu-lai-liao/activities" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>知乎</a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.uisdc.com/" title="优设" target="_blank">优设</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.zhangxinxu.com/" title="张鑫旭" target="_blank">张鑫旭</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.alloyteam.com/nav/" title="Web前端导航" target="_blank">Web前端导航</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.36zhen.com/t?id=3448" title="前端书籍资料" target="_blank">前端书籍资料</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://ife.baidu.com/" title="百度前端技术学院" target="_blank">百度前端技术学院</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://wf.uisdc.com/cn/" title="google前端开发基础" target="_blank">google前端开发基础</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
<link href="/css/thplayer.css" rel="stylesheet">
<div id="Thplayer"></div>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
<script type="application/javascript" src="/js/thplayer.min.js"></script>
<script>
    $("#Thplayer").thplayer({
           title: "给自己的歌",
           author: "高",
           cover: "/images/headpic.png",
           music: "/music/geizijidege.mp3"
    });
</script>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright" >
  
  &copy;  1994 &mdash; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">高哥哥</span>

  create by Mr.Gao
  <div class="powered-by">
  <i class="fa fa-user-md"></i>
  <span id="busuanzi_container_site_pv">
      本站总访问量<span id="busuanzi_value_site_pv"></span>次
  </span>
  <span class="post-count">博客全站共11.4k字</span>
  </div>

        







        
      </div>
    </footer>

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  



  
  



  
  



  
  





  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/three.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/canvas_sphere.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: false,
        notify: false,
        app_id: 'n8Ri3xDEFSjVSaN3jEqEyaJh-gzGzoHsz',
        app_key: 'KJmqmqPCwQK38fVbTBVtPMuG',
        placeholder: '请写一篇观后感'
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("n8Ri3xDEFSjVSaN3jEqEyaJh-gzGzoHsz", "KJmqmqPCwQK38fVbTBVtPMuG");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  


</body>
</html>
